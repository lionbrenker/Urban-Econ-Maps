<!DOCTYPE html>
<html>
<head>
    <title>Urban Econ Maps</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Leaflet CSS file -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
     
    <!-- Leaflet JavaScript file -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
     
    <!-- Our New Styles -->
    <style>
        /* Make the page and map fill the entire screen */
        body { 
            padding: 0; 
            margin: 0; 
            font-family: sans-serif;
        }
        html, body, #map {
            height: 100%;
            width: 100vw;
        }

        /* This is the new style for our floating panel */
        #panel {
            position: absolute; /* This is key: it takes the panel out of the normal flow */
            top: 10px;          /* 10 pixels from the top */
            right: 10px;        /* 10 pixels from the right */
            z-index: 1000;      /* Ensures it's on top of the map tiles */
            background: white;
            padding: 10px 20px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            width: 250px;
        }
        
        h2, h4 {
            margin-top: 0;
        }
    </style>
</head>
<body>

    <!-- The map container, which will fill the whole page -->
    <div id="map"></div>

    <!-- The HTML for our new floating control panel -->
    <div id="panel">
        <h2>Frankfurt Data</h2>
        <div class="layer-control">
            <h4>Select Data Layer:</h4>
            <input type="radio" id="housing" name="layer" value="housing_price" checked>
            <label for="housing">Housing Prices (€/m²)</label><br>
            <input type="radio" id="population" name="layer" value="population_density">
            <label for="population">Population Density</label><br>
        </div>
    </div>

    <script>
        // --- THIS JAVASCRIPT SECTION IS A PLACEHOLDER FOR THE NEXT PHASE ---
        // --- IT WILL NOT FULLY WORK UNTIL YOU ADD THE GEOJSON DATA   ---

        // 1. Initialize the map centered on Frankfurt
        var map = L.map('map').setView([50.1109, 8.6821], 12); // Centered on Frankfurt

        // Add a base tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // NOTE: The rest of this script is the logic for loading your data.
        // It will only work once you have found and uploaded your `frankfurt-data.geojson` file.
        // For now, it will simply show the base map and the panel.

        var geojsonLayer;

        function drawMap(data_property) {
            if (geojsonLayer) {
                map.removeLayer(geojsonLayer);
            }
            // The fetch will fail for now, which is expected.
            fetch('frankfurt-data.geojson')
                .then(response => {
                    if (!response.ok) {
                        console.log("Waiting for frankfurt-data.geojson file...");
                        return;
                    }
                    return response.json();
                })
                .then(data => {
                    if (!data) return;
                    geojsonLayer = L.geoJSON(data, { /* ... styling logic will go here ... */ }).addTo(map);
                });
        }

        var layerControls = document.querySelectorAll('input[name="layer"]');
        layerControls.forEach(function(radio) {
            radio.addEventListener('change', function() {
                // This will be ready to work once the data is available
                drawMap(this.value);
            });
        });

        // Initial call
        drawMap('housing_price');

    </script>

</body>
</html>
